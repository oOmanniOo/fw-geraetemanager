{% extends "base.html" %}

{% block title %}Gerätendetails{% endblock %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h2 class="mb-0">{{ object.bezeichnung }}</h2>
  <span class="badge {% if object.status == 'aktiv' or object.status %}bg-success{% else %}bg-danger{% endif %}">{{ object.status }}</span>
</div>

<div class="card mb-3">
  <div class="card-body">
    <div class="row g-2">
      <div class="col-md-6">
        <div class="text-muted small">Identifikation</div>
        <div class="fw-semibold">{{ object.identifikation }}</div>
      </div>
      <div class="col-md-6">
        <div class="text-muted small">Seriennummer</div>
        <div class="fw-semibold">{{ object.seriennummer|default:'—' }}</div>
      </div>
      <div class="col-md-6">
        <div class="text-muted small">Fahrzeug</div>
        <div class="fw-semibold">{{ object.geraeteraum.fahrzeug|default:'—' }}</div>
      </div>

      <div class="col-md-6">
        <div class="text-muted small">Geräteraum</div>
        <div class="fw-semibold">{{ object.geraeteraum.bezeichnung|default:'—' }}</div>
      </div>
      <div class="col-12">
        <div class="text-muted small">Bemerkung</div>
        <div>{{ object.bemerkung|default:'—' }}</div>
      </div>
    </div>
  </div>
</div>

<div class="d-flex gap-2">
  <a href="{% url 'geraete:bearbeiten' object.pk %}" class="btn btn-primary">Bearbeiten</a>
  <a href="{% url 'geraete:loeschen' object.pk %}" class="btn btn-outline-danger">Löschen</a>
  <a href="{% url 'geraete:liste' %}" class="btn btn-secondary">Zurück zur Liste</a>
</div>

 <h3>Prüfungen</h3>
  {% if pruefungen %}
    <table class="table table-striped align-middle">
      <thead>
        <tr>
          <th>Datum</th>
          <th>Art</th>
          <th>Prüfer</th>
          <th>Status</th>
          <th>Details</th>
        </tr>
      </thead>
      <tbody>
        {% for pruefung in pruefungen %}
          <tr>
            <td>{{ pruefung.datum }}</td>
            <td>{{ pruefung.art }}</td>
            <td>{{ pruefung.pruefer }}</td>
            <td>
              {% if pruefung.bestanden %}
                <span class="badge bg-success">Bestanden</span>
              {% else %}
                <span class="badge bg-danger">Nicht bestanden</span>
              {% endif %}
            </td>
            <td>
              <a href="{% url 'pruefungen:detail' pruefung.id %}" class="btn btn-sm btn-primary">
                Details
              </a>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p>Keine Prüfungen vorhanden.</p>
  {% endif %}

  <a href="{% url 'pruefungen:start' geraet.id %}" class="btn btn-danger mt-3">Neue Prüfung starten</a>
</div>
{% endblock %}
